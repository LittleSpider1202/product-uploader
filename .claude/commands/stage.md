---
description: é¡¹ç›®é˜¶æ®µç®¡ç†
argument-hint: [help|init|ls|req|design|dev|test|ok|pass|redo|back|clear]
---

# /stage å‘½ä»¤ - é¡¹ç›®é˜¶æ®µç®¡ç†

## æ‰§è¡ŒæŒ‡ä»¤

è¯·æ ¹æ®ç”¨æˆ·è¾“å…¥çš„å‚æ•° `$ARGUMENTS` æ‰§è¡Œç›¸åº”æ“ä½œï¼š

### help - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
è¾“å‡ºä»¥ä¸‹ä½¿ç”¨ç¤ºä¾‹ï¼š

```
/stage å‘½ä»¤å¸®åŠ©

ç”¨æ³•:
  /stage            æŸ¥çœ‹å½“å‰é˜¶æ®µçŠ¶æ€
  /stage ls         åˆ—å‡ºæ‰€æœ‰é˜¶æ®µ
  /stage init       åˆå§‹åŒ–é¡¹ç›®é˜¶æ®µæ–‡ä»¶å¤¹
  /stage req        åˆ‡æ¢åˆ°éœ€æ±‚é˜¶æ®µ
  /stage design     åˆ‡æ¢åˆ°è®¾è®¡é˜¶æ®µ
  /stage dev        åˆ‡æ¢åˆ°ç ”å‘é˜¶æ®µ
  /stage test       åˆ‡æ¢åˆ°æµ‹è¯•é˜¶æ®µ
  /stage ok         æäº¤å½“å‰é˜¶æ®µäº§å‡ºï¼Œè¯·æ±‚ review
  /stage pass       å®¡æ ¸é€šè¿‡ï¼Œè¿›å…¥ä¸‹ä¸€é˜¶æ®µ
  /stage redo       å½“å‰é˜¶æ®µè¿”å·¥
  /stage back <é˜¶æ®µ> å›é€€åˆ°æŒ‡å®šé˜¶æ®µ (å¦‚: /stage back req)
  /stage clear      æ¸…ç©ºå½“å‰ä¸Šä¸‹æ–‡ï¼Œé‡æ–°åŠ è½½å‰ç½®é˜¶æ®µæ–‡æ¡£

é˜¶æ®µæµç¨‹:
  éœ€æ±‚(req) â†’ è®¾è®¡(design) â†’ ç ”å‘(dev) â†’ æµ‹è¯•(test)
      â†‘                                      â†“
      â†â†â†â†â†â†â†â†â† åé¦ˆ/å›é€€ â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†
```

### æ— å‚æ•° - æŸ¥çœ‹çŠ¶æ€
è¯»å– `.claude/stage-state.json`ï¼Œè¾“å‡ºï¼š
- å½“å‰é˜¶æ®µ
- å½“å‰ç‰ˆæœ¬
- æ˜¯å¦ä¸º Plan æ¨¡å¼
- é˜¶æ®µå†å²

### ls - åˆ—å‡ºæ‰€æœ‰é˜¶æ®µ
è¾“å‡ºé˜¶æ®µåˆ—è¡¨ï¼š
1. éœ€æ±‚ (req) - å‘ç°é—®é¢˜ï¼Œç¡®è®¤åšä»€ä¹ˆ
2. è®¾è®¡ (design) - è§£æ„é—®é¢˜ï¼Œç¡®è®¤æ€ä¹ˆåš
3. ç ”å‘ (dev) - å®æ–½è½åœ°ï¼Œåšå‡ºæ¥
4. æµ‹è¯• (test) - æŠ•æ”¾éªŒè¯ï¼ŒéªŒè¯å¸‚åœº

### init - åˆå§‹åŒ–é¡¹ç›®
åˆ›å»ºé˜¶æ®µæ–‡ä»¶å¤¹ç»“æ„ï¼š

```
.claude/stages/
â”œâ”€â”€ requirement/           # éœ€æ±‚é˜¶æ®µ
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ design/               # è®¾è®¡é˜¶æ®µ
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ develop/              # ç ”å‘é˜¶æ®µ
â”‚   â”œâ”€â”€ docs/             # æŠ€æœ¯æ–‡æ¡£
â”‚   â””â”€â”€ src/              # æºä»£ç 
â””â”€â”€ test/                 # æµ‹è¯•é˜¶æ®µ
    â””â”€â”€ README.md
```

åˆå§‹åŒ–æ—¶åŒæ—¶é‡ç½® `stage-state.json` ä¸ºåˆå§‹çŠ¶æ€ã€‚

### req - åˆ‡æ¢åˆ°éœ€æ±‚é˜¶æ®µ
æ›´æ–° `stage-state.json`ï¼Œè®¾ç½®ï¼š
- currentStage: "requirement"
- planMode: true

**ä¸Šä¸‹æ–‡ï¼š**
- è§’è‰²ï¼šäº§å“ç»ç†è§†è§’
- å…³æ³¨ï¼šç”¨æˆ·ç—›ç‚¹ã€å¸‚åœºæœºä¼šã€éœ€æ±‚è¾¹ç•Œ
- æ¨¡å¼ï¼šğŸ”’ Plan æ¨¡å¼ï¼ˆåªæ¢ç´¢ã€ä¸å†™ä»£ç ï¼‰
- äº§å‡ºï¼šéœ€æ±‚ç‚¹æ¸…å• â†’ `.claude/stages/requirement/`

### design - åˆ‡æ¢åˆ°è®¾è®¡é˜¶æ®µ
æ›´æ–° `stage-state.json`ï¼Œè®¾ç½®ï¼š
- currentStage: "design"
- planMode: true

**ä¸Šä¸‹æ–‡ï¼š**
- è§’è‰²ï¼šäº§å“æ¶æ„å¸ˆè§†è§’
- å…³æ³¨ï¼šç³»ç»Ÿè§£æ„ã€è§’è‰²èŒè´£ã€æµç¨‹è®¾è®¡ã€è¯„ä»·ä½“ç³»ã€äº¤äº’è®¾è®¡
- æ¨¡å¼ï¼šğŸ”’ Plan æ¨¡å¼ï¼ˆåªè®¾è®¡ã€ä¸å†™ä»£ç ï¼‰
- äº§å‡ºï¼šPRDæ–‡æ¡£ â†’ `.claude/stages/design/`
- å‚è€ƒï¼šCLAUDE.md ä¸­çš„ PRDæ¨¡æ¿

### dev - åˆ‡æ¢åˆ°ç ”å‘é˜¶æ®µ
æ›´æ–° `stage-state.json`ï¼Œè®¾ç½®ï¼š
- currentStage: "develop"
- planMode: false

**ä¸Šä¸‹æ–‡ï¼š**
- è§’è‰²ï¼šæŠ€æœ¯æ¶æ„å¸ˆ/å¼€å‘è€…è§†è§’
- å…³æ³¨ï¼šæ¨¡å—åˆ’åˆ†ã€æŠ€æœ¯é€‰å‹ã€ä»£ç å®ç°ã€å·¥ç¨‹æµ‹è¯•
- æ¨¡å¼ï¼šæ­£å¸¸æ¨¡å¼ï¼ˆå¯ä»¥å†™ä»£ç ï¼‰
- äº§å‡ºï¼šæŠ€æœ¯æ–‡æ¡£ â†’ `.claude/stages/develop/docs/`ï¼Œæºä»£ç  â†’ `.claude/stages/develop/src/`

### test - åˆ‡æ¢åˆ°æµ‹è¯•é˜¶æ®µ
æ›´æ–° `stage-state.json`ï¼Œè®¾ç½®ï¼š
- currentStage: "test"
- planMode: false

**ä¸Šä¸‹æ–‡ï¼š**
- è§’è‰²ï¼šäº§å“è¿è¥è§†è§’
- å…³æ³¨ï¼šPMFéªŒè¯ã€ç”¨æˆ·åé¦ˆã€è¿­ä»£æ–¹å‘
- æ¨¡å¼ï¼šæ­£å¸¸æ¨¡å¼
- äº§å‡ºï¼šéªŒè¯æŠ¥å‘Š + ä¸‹ä¸€è½®éœ€æ±‚ â†’ `.claude/stages/test/`

### ok - æäº¤å½“å‰é˜¶æ®µäº§å‡º
- å°†å½“å‰é˜¶æ®µçŠ¶æ€æ›´æ–°ä¸º "pending_review"
- è¾“å‡ºå½“å‰é˜¶æ®µçš„äº§å‡ºç‰©åˆ—è¡¨ï¼Œè¯·æ±‚ review

### pass - å®¡æ ¸é€šè¿‡
- å°†å½“å‰é˜¶æ®µçŠ¶æ€æ›´æ–°ä¸º "passed"
- è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€é˜¶æ®µ
- å¦‚æœå½“å‰æ˜¯ test é˜¶æ®µï¼Œè¯¢é—®æ˜¯å¦å¼€å§‹æ–°ç‰ˆæœ¬è¿­ä»£

### redo - å½“å‰é˜¶æ®µè¿”å·¥
- å°†å½“å‰é˜¶æ®µçŠ¶æ€æ›´æ–°ä¸º "rework"
- ä¿æŒåœ¨å½“å‰é˜¶æ®µ

### back <é˜¶æ®µ> - å›é€€åˆ°æŒ‡å®šé˜¶æ®µ
- è®°å½•å›é€€åŸå› 
- ä¿ç•™å†å²çº¦æŸ
- åˆ‡æ¢åˆ°ç›®æ ‡é˜¶æ®µ
- ç¤ºä¾‹ï¼š`/stage back req` å›é€€åˆ°éœ€æ±‚é˜¶æ®µ

### clear - æ¸…ç©ºä¸Šä¸‹æ–‡å¹¶é‡è½½æ–‡æ¡£
- å£°æ˜"å½“å‰é˜¶æ®µä¸Šä¸‹æ–‡å·²æ¸…ç©ºï¼Œä»…åŠ è½½å‰ç½®é˜¶æ®µæ–‡æ¡£"
- æ ¹æ®å½“å‰é˜¶æ®µåŠ è½½å‰ç½®æ–‡æ¡£ï¼š
  - requirement é˜¶æ®µ â†’ æ— å‰ç½®æ–‡æ¡£ï¼Œä»é›¶å¼€å§‹
  - design é˜¶æ®µ â†’ åŠ è½½ `requirement/` ä¸‹çš„ MRD
  - dev é˜¶æ®µ â†’ åŠ è½½ `design/` ä¸‹çš„ PRD
  - test é˜¶æ®µ â†’ åŠ è½½ `design/` ä¸‹çš„ PRD
- è¾“å‡ºå·²åŠ è½½çš„æ–‡æ¡£åˆ—è¡¨
- æç¤ºç”¨æˆ·å¯ä»¥é‡æ–°å¼€å§‹å½“å‰é˜¶æ®µå·¥ä½œ

## Plan æ¨¡å¼è§„åˆ™
å½“å¤„äº req æˆ– design é˜¶æ®µæ—¶ï¼Œè‡ªåŠ¨è¿›å…¥ Plan æ¨¡å¼ï¼š
- åªèƒ½ä½¿ç”¨æ¢ç´¢ç±»å·¥å…·ï¼ˆReadã€Globã€Grepã€WebSearchã€WebFetchï¼‰
- ç¦æ­¢ä½¿ç”¨ç¼–è¾‘ç±»å·¥å…·å†™ä»£ç 
- äº§å‡ºç‰©ä¸º Markdown æ–‡æ¡£ï¼Œå­˜æ”¾åˆ°å¯¹åº”é˜¶æ®µç›®å½•
- ä½¿ç”¨ `/stage ok` å®Œæˆæ–‡æ¡£åè¯·æ±‚ review

## çŠ¶æ€æ–‡ä»¶æ ¼å¼
```json
{
  "currentStage": "design",
  "version": 1,
  "planMode": true,
  "history": [
    {"stage": "requirement", "version": 1, "status": "passed", "timestamp": "..."},
    {"stage": "design", "version": 1, "status": "in_progress", "timestamp": "..."}
  ],
  "constraints": []
}
```
